<header>
    <div class="navbar">
        <ul class="nav navbar-nav">
            <li class="navbar-brand"><img src="/img/favicon.png" height="30" alt=""/></li>
            <li ng-class="{'active': collection.key  == 'listings'}"><a href="/market/listings">Listings</a></li>
            <li ng-class="{'active': collection.key == 'news'}"><a href="/market/news">News</a></li>
            <li></li>
        </ul>

        <div class="btn-group pull-right">
            <button type="button" ng-click="newItem()" class="btn btn-info hint--left hint--bounce" data-hint="New {{ collection.title }}">
                <i class="icon-plus-sign"></i>
            </button>
        </div>
    </div>
</header>

<div class="roomba-wrap">
    <div class="row">
        <div ui-if="!marketView.collapseFilters" class="col-lg-2 market-filter" ng-controller="MarketFilterCtrl">
            <div class="row">
                <div class="col-lg-12 header-actions">
                    <div class="btn-group">
                        <button type="button" class="btn btn-danger dropdown-toggle hint--right hint--info hint--bounce"
                                ng-click="marketView.collapseFilters = true" data-hint="Collapse">
                            <i class="icon-remove"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="row scroll-container">
                <div class="scroll-wrap">
                    <div class="header-search col-lg-12">
                        <input type="text" placeholder="Search by {{ activeSearch.title }}"
                               ng-model="searchBy[activeSearch.key]"/>
                        <i class="icon-search"></i>

                        <div class="input-dropdown-btn" dropdown-toggle><i class="icon-caret-down"></i></div>
                        <ul class="input-dropdown-menu">
                            <li ng-click="setSearchCriteria()"><a href="javascript:">Any</a></li>
                            <li ng-class="{'active': field.key == activeSearch.key}"
                                ng-repeat="field in collection.fields | orderBy: '-weight'"
                                ng-click="setSearchCriteria(field)">
                                <a href="javascript:">{{field.title}}</a>
                            </li>
                        </ul>
                    </div>

                    <div class="col-lg-12">
                        <ul ng-repeat="range in dimensions.range" class="ribbon-nav">
                            <li class="header">{{range.title}} <div class="pull-right">{{range.lowSelected}} - {{range.highSelected}}</div></li>
                            <div class="slider-container" slider></div>
                        </ul>
                    </div>


                    <div class="col-lg-12">
                        <ul ng-repeat="discreet in dimensions.discreet" class="ribbon-nav">
                            <li class="header">{{discreet.title}}</li>
                            <li ng-repeat="value in discreet.values"
                                ng-class="{'active': value.isSelected}"
                                ng-click="toggleDiscreet(discreet, value)"><a href="javascript:">{{value.title}}</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="market-list col-lg-4"
             ng-controller="MarketListCtrl">
            <div class="row">
                <div class="col-lg-12 header-actions">
                    <div class="btn-group">
                        <button type="button" ui-if="marketView.collapseFilters"
                                class="btn btn-info hint--bottom hint--info hint--bounce"
                                ng-click="marketView.collapseFilters = false" data-hint="Expand Search">
                            <i class="icon-search"></i>
                        </button>
                    </div>
                    <div class="btn-group">
                        <button type="button" class="btn btn-inverse dropdown-toggle hint--top hint--info hint--bounce"
                                data-hint="Sort">
                            <i class="icon-sort"></i>
                        </button>
                        <ul class="dropdown-menu">
                            <li ng-class="{'active': isActive}" ng-repeat="(sortField, isActive) in sortFields">
                                <a href="javascript:" ng-click="setSortField(sortField)">{{ sortField }}</a>
                            </li>
                        </ul>
                    </div>
                    <div class="btn-group pull-right">
                        <button class="btn hint--top hint--info hint--bounce" data-hint="Publish Selected"
                                ng-click="publishSelected()">
                            <i class="icon-cloud-upload"></i>
                        </button>
                        <button class="btn btn-danger hint--bottom hint--error hint--bounce"
                                ng-click="unpublishSelected()"
                                data-hint="Un Publish Selected">
                            <i class="icon-cloud"></i>
                        </button>
                        <button class="btn btn-success hint--top hint--success hint--bounce"
                                data-hint="Save Selected"
                                ng-click="saveSelected()">
                            <i class="icon-save"></i>
                        </button>
                        <button class="btn btn-danger hint--bottom hint--error hint--bounce"
                                ng-click="flagSelected()"
                                data-hint="Flag Selected">
                            <i class="icon-flag"></i>
                        </button>
                    </div>

                </div>
            </div>
            <div class="scroll-container">
                <div class="scroll-wrap"
                     chunk="filteredItems = (items | filter:searchBy[activeSearch.key] | limitVisible | orderBy:sortBy)"
                     chunk-size="100">

                    <div class="row label-list-item" ng-click="toggleSelectAll()">
                        Select {{ filteredItems.length }} items
                    </div>
                    <div class="row listing-list-item" ng-class="{'active': item.isActive}" ng-repeat="item in chunk">
                        <div class="col-lg-1 col-sm-1 col-1"><input type="checkbox" ng-model="item.isSelected"/></div>

                        <div class="col-lg-9 col-sm-6 col-6 list-item-title" ng-class="{'bold': hasTag(item, 'edited')}"
                             ng-click="openDetails(item)">
                            {{item.title}}  <i class="icon-flag status-text-error" ng-show="hasTag(item, 'flagged')"></i>

                        </div>
                        <div class="col-lg-2 col-sm-3 col-3">
                            <div class="progress progress-striped">
                                <div class="progress-bar {{ item.progressClass }}"
                                     ng-style="{width: item.calcFillPercent()}"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div ng-class="(marketView.collapseFilters && 'col-lg-8' || 'col-lg-6')" class="col-lg-6 market-details"
             ng-controller="DetailsCtrl">
            <div class="row">
                <div class="col-lg-12 header-actions">
                    <div class="btn-group pull-left">
                        <a class="btn btn-inverse" target="_blank" ng-href="{{activeItem.raw.pages[0].url.value}}"
                           ng-class="{'disabled': !activeItem}">
                            Open
                        </a>
                    </div>
                    <div class="btn-group pull-right">
                        <button class="btn btn-success btn-glossy" ng-click="saveItem(activeItem)"
                                ng-class="{'disabled': !activeItem}">
                            Save
                        </button>
                    </div>
                </div>
            </div>

            <div class="scroll-container row" ng-show="activeItem" spinner="activeItem.$spinner" spinner-size="large">
                <div class="scroll-wrap">
                    <div ng-include="srcListingDetails"></div>
                </div>
            </div>
        </div>
    </div>
</div>